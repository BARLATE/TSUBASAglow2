<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>MOMOA育成RPG</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Rounded+M+PLUS+1c&display=swap" rel="stylesheet">
  <style>
    /* 省略：CSS部分は元と同じなのでここではカットしてもOK */
  </style>

  <!-- Fireworks.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/fireworks-js@2.1.0/dist/fireworks.js"></script>

  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
</head>
<body>

<audio id="tapSound" src="tap.mp3" preload="auto"></audio>
<audio id="levelUpSound" src="levelup.mp3" preload="auto"></audio>

<!-- Fireworks Container -->
<div id="fireworkContainer" style="position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:999;"></div>
<div class="effect-flash" id="flashEffect"></div>
<div id="qr-reader" style="width: 300px; margin: auto; display: none;"></div>

<!-- 以下：UI表示（タイトル・キャラ画像・ステータスなど） -->
<!-- 省略：HTML構造はそのまま維持 -->

<script>
  // ...元のロジックの上に以下を追加...

  // Fireworks setup
  let fireworksInstance = null;

  function launchNormalFireworks(charName) {
    const container = document.getElementById("fireworkContainer");
    const characterColors = {
      TSUBASA: "#ff4444",
      KAEDE: "#ff99cc",
      MOMOA: "#ffcc00",
      RIN: "#aa88ff"
    };
    const color = characterColors[charName] || "#ffffff";
    if (fireworksInstance) fireworksInstance.stop();
    fireworksInstance = new Fireworks(container, {
      hue: { min: 0, max: 360 },
      delay: { min: 15, max: 30 },
      rocketsPoint: 50,
      speed: 3,
      acceleration: 1.03,
      friction: 0.95,
      gravity: 1.4,
      particles: 60,
      trace: 3,
      explosion: 5,
      brightness: { min: 50, max: 80 },
      boundaries: { top: 0, bottom: container.clientHeight, left: 0, right: container.clientWidth },
      sound: { enabled: false },
      color: color
    });
    fireworksInstance.start();
    setTimeout(() => fireworksInstance.stop(), 2500);
  }

  function launchLevelUpFireworks() {
    const container = document.getElementById("fireworkContainer");
    if (fireworksInstance) fireworksInstance.stop();
    fireworksInstance = new Fireworks(container, {
      hue: { min: 45, max: 55 },
      delay: { min: 5, max: 15 },
      rocketsPoint: 50,
      speed: 4,
      acceleration: 1.08,
      friction: 0.93,
      gravity: 1.3,
      particles: 120,
      trace: 6,
      explosion: 8,
      brightness: { min: 70, max: 100 },
      boundaries: { top: 0, bottom: container.clientHeight, left: 0, right: container.clientWidth },
      sound: { enabled: false }
    });
    fireworksInstance.start();
    setTimeout(() => fireworksInstance.stop(), 4000);
  }

  // ...giveDrink() の中に以下追加済み...
  // tapAudio.play();
  // launchNormalFireworks("MOMOA");

  // levelUpAudio.play();
  // launchLevelUpFireworks();

  // ...その他の処理は元のまま...
</script>

</body>
</html>